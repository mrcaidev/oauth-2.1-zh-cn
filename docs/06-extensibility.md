**目录**

- [6. 扩展性能](#6-扩展性能)
  - [6.1. 定义访问令牌类型](#61-定义访问令牌类型)
    - [6.1.1. 注册的访问令牌类型](#611-注册的访问令牌类型)
    - [6.1.2. 供应商特定的访问令牌类型](#612-供应商特定的访问令牌类型)
  - [6.2. 定义新的端点参数](#62-定义新的端点参数)
  - [6.3. 定义新的授权许可类型](#63-定义新的授权许可类型)
  - [6.4. 定义新的授权端点响应类型](#64-定义新的授权端点响应类型)
  - [6.5. 定义额外的错误代码](#65-定义额外的错误代码)

# 6. 扩展性能

## 6.1. 定义访问令牌类型

访问令牌的类型可以使用两种方法之一：（遵循 [[RFC6749](https://www.rfc-editor.org/info/rfc6749)] 第 11.1 节的步骤）在访问令牌类型注册表中注册，或者将唯一的绝对 URI 作为其名称。

### 6.1.1. 注册的访问令牌类型

在 [[RFC6749](https://www.rfc-editor.org/info/rfc6749)] 第 11.4 节中，[[RFC6750](https://www.rfc-editor.org/info/rfc6750)] 建立了一张通用注册表，用于在 OAuth 令牌认证方案之间共享错误值。

主要为 OAuth 令牌认证而设计的新认证方案**应该**定义一种机制，用于向客户端提供错误状态码，其中所允许的错误值被注册在该规范建立的错误注册表中。

这种方案**可以**将有效错误代码集限制为注册值的一个子集。如果使用命名参数返回错误代码，那么参数名称**应该**为 error。

其它可用于 OAuth 令牌认证、但并非主要为该目的而设计的方案，可以使用同样的方式将其错误值与注册表绑定。

新的认证方案也**可以**选择指定 error_description 和 error_uri 返回错误信息的用法，其用法与该规范中的用法类似。

类型名称必须符合 type-name 的 ABNF。如果类型定义包含了一种新的 HTTP 认证方案，那么类型名称应该与（[[RFC2617](https://www.rfc-editor.org/info/rfc2617)] 定义的）HTTP 认证方案名称保持一致。令牌类型 example 保留给示例使用。

```abnf
type-name  = 1*name-char
name-char  = "-" / "." / "_" / DIGIT / ALPHA
```

### 6.1.2. 供应商特定的访问令牌类型

使用 URI 名称的类型应该限于供应商特定的实现，不普遍适用，并且与使用它们的资源服务器的实现细节有关。

其它所有类型**必须**被注册。

## 6.2. 定义新的端点参数

用于授权端点或令牌端点的新请求参数或新响应参数，遵循 [[RFC6749](https://www.rfc-editor.org/info/rfc6749)] 第 11.2 节的步骤，在 OAuth 参数注册表中定义并注册。

参数名称**必须**符合 param-name 的 ABNF。参数值的语法**必须**有明确定义（例如，使用 ABNF，或者引用现有参数的语法）。

```abnf
param-name  = 1*name-char
name-char   = "-" / "." / "_" / DIGIT / ALPHA
```

对于未注册的、供应商特定的参数扩展，如果其不普遍适用，而是与使用它们的资源服务器的实现细节有关，那么其**应该**使用供应商特定的前缀。该前缀不可能与其它已注册的值冲突（例如，以公司名称开头）。

## 6.3. 定义新的授权许可类型

要定义新的授权许可类型，可以为其分配一个唯一的绝对 URI，并与 grant_type 参数一起使用。如果扩展许可类型需要额外的令牌端点参数，那么这些参数**必须**在 OAuth 参数注册表中注册，如 [[RFC6749](https://www.rfc-editor.org/info/rfc6749)] 所述。

## 6.4. 定义新的授权端点响应类型

用于授权端点的新响应类型，遵循 [RFC6749] 第 11.3 节的步骤，在授权端点响应类型注册表中定义并注册。响应类型名称**必须**符合 response-type 的 ABNF。

```abnf
response-type  = response-name *( SP response-name )
response-name  = 1*response-char
response-char  = "_" / DIGIT / ALPHA
```

如果一种响应类型包含了一个或多个空格字符（%x20），那么它以用空格分隔的值列表的形式被比较，其中值的顺序不重要。只有一种值的顺序可以被注册，其覆盖了相同值集合的其它所有排列。

例如，一项扩展可以定义并注册响应类型 code other_token。一旦注册，该组合就不能被注册为 other_token code，但两者都可以用于表示同一种响应类型。

## 6.5. 定义额外的错误代码

如果协议扩展（也就是，访问令牌类型、扩展参数，或者扩展许可类型）需要额外的错误代码，用于授权码许可的错误响应（第 4.1.2.1 节）、令牌端点的错误响应（第 3.2.4 节），或者资源访问的错误响应，这种错误代码**可以**被定义。

如果与扩展错误代码一起使用的扩展是已注册的访问令牌类型、已注册的端点参数，或者扩展许可类型，那么扩展错误代码**必须**（遵循 [[RFC6749](https://www.rfc-editor.org/info/rfc6749)] 第 11.4 节的步骤）被注册。用于未注册扩展的错误代码**可以**被注册。

错误代码**必须**符合 error 的 ABNF。如果可能，错误代码**应该**使用标识名称作为前缀。例如，表示扩展参数 example 被设置为无效值的错误**应该**被命名为 example_invalid。

```abnf
error      = 1*error-char
error-char = %x20-21 / %x23-5B / %x5D-7E
```
